{"version":3,"file":"linkedIn.handler.js","names":["_uuid","require","_playwright","_bigquery","_linkedIn","_audit","_linkedInJobStorage","_dateFns","TABLE_LINKEDIN_JOBS","process","env","checkLinkedInTableExists","rows","bigquery","query","console","log","length","error","Error","createLinkedInTableIfNotExists","createLinkedInJobHandler","jobData","file","title","company","link","carrierPathLink","location","datePosted","entityURN","jobDescription","missingFields","push","join","success","message","existingJob","PROJECT_ID","DATASET_ID","params","warn","jobId","uuidv4","createdAt","Date","toISOString","uploadedImgUrl","fileName","mimetype","split","uploadLinkedInImageToGCS","buffer","linkedInQueries","createLinkedInJob","id","jobTrigger","imgSrc","exports","getExistingEntityURNs","Set","map","row","convertRelativeDate","relativeDate","now","regex","match","value","parseInt","unit","exactDate","subDays","subWeeks","subMonths","subYears","format","fetchLinkedInJobs","deleteJobBoard","deleteOldAutomationJobs","JSON","stringify","browser","chromium","launch","headless","page","newPage","allJobs","jobRoles","locations","scrapedEntityURNs","role","hasMoreJobs","currentPage","LINKEDIN_URL","encodeURIComponent","goto","waitUntil","timeout","jobCards","$$","jobs","card","job","evaluate","node","querySelector","textContent","trim","getAttribute","has","add","concat","waitForTimeout","close","storeJobsInBigQuery","status","existingEntityURNs","uniqueJobs","filter","isDuplicate","insertLinkedInJob","getAllLinkedInHandler","getAllLinkedInJobs","updateLinkedInJobHandler","linkedInResults","Array","isArray","replace","updateCarrierPathLinkJobHandler","updatedData","deleteLinkedInJobHandler","req","user","auditLogParams","entityType","entityId","action","previousData","performedBy","auditQueries","insertAuditLog","errors","deleteLinkedInAutomationJobHandler","deleteAllAutomationJobs"],"sources":["../../../src/endpoints/linkedinJobs/linkedIn.handler.ts"],"sourcesContent":["import { v4 as uuidv4 } from 'uuid';\r\nimport { chromium } from 'playwright';\r\nimport { bigquery } from '../../config/bigquery';\r\nimport { linkedInQueries } from '../../queries/linkedIn/linkedIn.queries';\r\nimport { LinkedIn } from 'db/models/LinkedIn';\r\nimport { auditQueries } from 'queries/audit/audit.queries';\r\nimport { uploadLinkedInImageToGCS } from '../../config/linkedInJobStorage';\r\nimport { format, subDays, subWeeks, subMonths, subYears } from 'date-fns';\r\n\r\ninterface FetchLinkedInJobsResponse {\r\n  status: 'success' | 'error';\r\n  jobs?: LinkedIn[];\r\n  message?: string;\r\n}\r\n\r\nconst TABLE_LINKEDIN_JOBS = process.env.TABLE_LINKEDIN_JOBS;\r\n\r\n// Function to check if the linkedIn table exists\r\nconst checkLinkedInTableExists = async (): Promise<boolean> => {\r\n  try {\r\n    const [rows] = await bigquery.query({\r\n      query: `SELECT table_name FROM \\`teqcertify.lms.INFORMATION_SCHEMA.TABLES\\`\r\n      WHERE table_name = 'jobTables'\r\n      `\r\n    });\r\n    console.log(`Table exists: ${rows.length > 0}`);\r\n    return rows.length > 0;\r\n  } catch (error) {\r\n    console.error('Error checking table existence:', error);\r\n    throw new Error('Database error while checking table existence.');\r\n  }\r\n};\r\n\r\n// Function to create the job table if it does not exist\r\nconst createLinkedInTableIfNotExists = async (): Promise<void> => {\r\n  if (!(await checkLinkedInTableExists())) {\r\n    try {\r\n      console.log('Creating LinkedIn table...');\r\n      await bigquery.query({\r\n        query: `\r\n          CREATE TABLE \\`teqcertify.lms.jobTables\\` (\r\n            id STRING NOT NULL, \r\n            title STRING NOT NULL,\r\n            company STRING NOT NULL,\r\n            link STRING NOT NULL,\r\n            carrierPathLink STRING,\r\n            location STRING NOT NULL,\r\n            datePosted STRING NOT NULL,\r\n            entityURN STRING NOT NULL,\r\n            imgSrc STRING NOT NULL,\r\n            jobDescription STRING,\r\n            jobTrigger STRING,\r\n            createdBy STRING,\r\n            updatedBy STRING,\r\n            createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\r\n            updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP\r\n          )`\r\n      });\r\n      console.log('LinkedIn Job table created successfully.');\r\n    } catch (error) {\r\n      console.error('Error creating LinkedIn job table:', error);\r\n      throw new Error('Failed to create LinkedIn job table.');\r\n    }\r\n  }\r\n};\r\n\r\n// Create LinkedIn Job Handler\r\nexport const createLinkedInJobHandler = async (\r\n  jobData: Partial<LinkedIn>,\r\n  file?: Express.Multer.File\r\n) => {\r\n  const {\r\n    title,\r\n    company,\r\n    link,\r\n    carrierPathLink, // Added in validation\r\n    location,\r\n    datePosted,\r\n    entityURN, // Must be used correctly\r\n    jobDescription\r\n  } = jobData;\r\n\r\n  // Required fields validation\r\n  const missingFields = [];\r\n  if (!title) missingFields.push('title');\r\n  if (!company) missingFields.push('company');\r\n  if (!link) missingFields.push('link');\r\n  if (!location) missingFields.push('location');\r\n  if (!datePosted) missingFields.push('datePosted');\r\n  if (!entityURN) missingFields.push('entityURN'); // Ensure entityURN is provided\r\n\r\n  if (missingFields.length > 0) {\r\n    console.error(`Missing required fields: ${missingFields.join(', ')}`);\r\n    return {\r\n      success: false,\r\n      message: `Missing required fields: ${missingFields.join(', ')}`\r\n    };\r\n  }\r\n\r\n  try {\r\n    await createLinkedInTableIfNotExists();\r\n    console.log('Checking if job already exists...');\r\n\r\n    // Check if job with same entityURN already exists\r\n    const [existingJob] = await bigquery.query({\r\n      query: `\r\n        SELECT id FROM \\`${process.env.PROJECT_ID}.${process.env.DATASET_ID}.${process.env.TABLE_LINKEDIN_JOBS}\\`\r\n        WHERE entityURN = @entityURN\r\n      `,\r\n      params: { entityURN } // Ensure correct param structure\r\n    });\r\n\r\n    if (existingJob && existingJob.length > 0) {\r\n      console.warn(`Job with entityURN \"${entityURN}\" already exists.`);\r\n      return { success: false, message: 'Job already exists.' };\r\n    }\r\n\r\n    console.log('Creating new LinkedIn job...');\r\n    const jobId = uuidv4();\r\n    const createdAt = new Date().toISOString();\r\n    let uploadedImgUrl = '';\r\n\r\n    // Upload image to GCS if provided\r\n    if (file) {\r\n      const fileName = `${jobId}.${file.mimetype.split('/')[1]}`;\r\n      console.log('Uploading job image to GCS...');\r\n      uploadedImgUrl = await uploadLinkedInImageToGCS(\r\n        file.buffer,\r\n        fileName,\r\n        file.mimetype\r\n      );\r\n    }\r\n\r\n    console.log('Inserting job info into BigQuery...');\r\n    await bigquery.query({\r\n      query: linkedInQueries.createLinkedInJob,\r\n      params: {\r\n        id: jobId,\r\n        title,\r\n        company,\r\n        link,\r\n        carrierPathLink: carrierPathLink || '', // Ensure this is defined\r\n        jobTrigger: 'Manual', // Set to 'Manual' for manual jobs\r\n        location,\r\n        datePosted,\r\n        entityURN, // Use provided entityURN (not uuidv4())\r\n        imgSrc: uploadedImgUrl || '',\r\n        jobDescription,\r\n        createdAt\r\n      }\r\n    });\r\n\r\n    console.log(`LinkedIn job created successfully. ID: ${jobId}`);\r\n\r\n    return {\r\n      success: true,\r\n      message: 'LinkedIn job created successfully.',\r\n      jobId,\r\n      imgSrc: uploadedImgUrl,\r\n      jobData\r\n    };\r\n  } catch (error) {\r\n    console.error('Error creating LinkedIn job:', error);\r\n    return {\r\n      success: false,\r\n      message:\r\n        error instanceof Error ? error.message : 'Unknown error occurred.'\r\n    };\r\n  }\r\n};\r\n\r\n//Entity URN Checking\r\nconst getExistingEntityURNs = async (): Promise<Set<string>> => {\r\n  try {\r\n    const query = `\r\n      SELECT LOWER(entityURN) as entityURN\r\n      FROM \\`${process.env.PROJECT_ID}.${process.env.DATASET_ID}.${process.env.TABLE_LINKEDIN_JOBS}\\`\r\n    `;\r\n\r\n    const [rows] = await bigquery.query({ query });\r\n    return new Set(rows.map((row: any) => row.entityURN));\r\n  } catch (error) {\r\n    console.error('Error fetching existing entityURNs:', error);\r\n    return new Set();\r\n  }\r\n};\r\n\r\n// Get Linkedin Jobs using Chromium\r\n// export const fetchLinkedInJobs = async (\r\n//   jobRoles: string[],\r\n//   locations: string[] = ['India']\r\n// ): Promise<FetchLinkedInJobsResponse> => {\r\n\r\n//   console.log('Deleting all jobs with jobTrigger: Automation');\r\n\r\n//   if (!(await checkLinkedInTableExists()))\r\n//     throw new Error(`Table '${TABLE_LINKEDIN_JOBS}' does not exist.`);\r\n\r\n//   // Delete all jobs where jobTrigger = 'Automation'\r\n//   const deleteJobBoard = await bigquery.query({\r\n//     query: linkedInQueries.deleteAllAutomationJobs\r\n//   });\r\n\r\n//   console.log('Deleted Data', JSON.stringify(deleteJobBoard));\r\n\r\n//   console.log('All Automation jobs deleted successfully.');\r\n\r\n//   const browser = await chromium.launch({ headless: false }); // Debugging\r\n//   const page = await browser.newPage();\r\n//   let allJobs: LinkedIn[] = [];\r\n\r\n//   // Set to track unique entityURNs during scraping\r\n//   const scrapedEntityURNs = new Set<string>();\r\n\r\n//   try {\r\n//     for (const role of jobRoles) {\r\n//       for (const location of locations.length > 0 ? locations : ['India']) {\r\n//         let hasMoreJobs = true;\r\n//         let currentPage = 0;\r\n\r\n//         while (hasMoreJobs && currentPage < 5) {\r\n//           // Prevent infinite loop\r\n//           const LINKEDIN_URL = `https://www.linkedin.com/jobs/search/?keywords=${encodeURIComponent(\r\n//             role\r\n//           )}&location=${encodeURIComponent(location)}&start=${currentPage * 20}`;\r\n\r\n//           try {\r\n//             console.log(`Navigating to: ${LINKEDIN_URL}`);\r\n//             await page.goto(LINKEDIN_URL, {\r\n//               waitUntil: 'networkidle',\r\n//               timeout: 60000\r\n//             });\r\n\r\n//             const jobCards = await page.$$('.job-search-card');\r\n//             if (jobCards.length === 0) {\r\n//               console.log(`No jobs found for ${role} in ${location}`);\r\n//               hasMoreJobs = false;\r\n//               break;\r\n//             }\r\n\r\n//             const jobs: LinkedIn[] = [];\r\n//             for (const card of jobCards) {\r\n//               const job = await card.evaluate((node) => ({\r\n//                 title:\r\n//                   node\r\n//                     .querySelector('.base-search-card__title')\r\n//                     ?.textContent?.trim() || 'No title',\r\n//                 company:\r\n//                   node\r\n//                     .querySelector('.base-search-card__subtitle')\r\n//                     ?.textContent?.trim() || 'No company',\r\n//                 link:\r\n//                   node\r\n//                     .querySelector('.base-card__full-link')\r\n//                     ?.getAttribute('href') || 'No link',\r\n//                 location:\r\n//                   node\r\n//                     .querySelector('.job-search-card__location')\r\n//                     ?.textContent?.trim() || 'No location',\r\n//                 datePosted:\r\n//                   node\r\n//                     .querySelector('.job-search-card__listdate')\r\n//                     ?.textContent?.trim() || 'No date',\r\n//                 entityURN: node.getAttribute('data-entity-urn')?.trim() || '', // Ensure no empty URNs\r\n//                 imgSrc:\r\n//                   node\r\n//                     .querySelector('.artdeco-entity-image')\r\n//                     ?.getAttribute('src') || 'No image',\r\n//                 jobDescription:\r\n//                   node\r\n//                     .querySelector('.job-search-card__desc')\r\n//                     ?.textContent?.trim() || 'No description'\r\n//               }));\r\n\r\n//               // Ensure entityURN is valid and not already scraped\r\n//               if (job.entityURN && !scrapedEntityURNs.has(job.entityURN)) {\r\n//                 scrapedEntityURNs.add(job.entityURN); // Add to Set to avoid duplicates\r\n\r\n//                 jobs.push({\r\n//                   id: uuidv4(),\r\n//                   ...job,\r\n//                   createdAt: new Date().toISOString(),\r\n//                   jobTrigger: 'Automation',\r\n//                   carrierPathLink: '',\r\n//                   createdBy: '',\r\n//                   updatedBy: '',\r\n//                   updatedAt: ''\r\n//                 });\r\n//               }\r\n//             }\r\n\r\n//             if (jobs.length === 0) {\r\n//               hasMoreJobs = false;\r\n//             } else {\r\n//               allJobs = allJobs.concat(jobs);\r\n//               currentPage++;\r\n//             }\r\n//           } catch (error) {\r\n//             console.error(\r\n//               `Error loading page for \"${role}\" in \"${location}\":`,\r\n//               error\r\n//             );\r\n//             hasMoreJobs = false;\r\n//           }\r\n//           await page.waitForTimeout(5000); // Avoid detection\r\n//         }\r\n//       }\r\n//     }\r\n\r\n//     await browser.close();\r\n\r\n//     if (allJobs.length > 0) {\r\n//       await storeJobsInBigQuery(allJobs);\r\n//       console.log(`Fetched and stored ${allJobs.length} unique jobs.`);\r\n//     } else {\r\n//       console.log('No jobs found.');\r\n//     }\r\n\r\n//     return { status: 'success', jobs: allJobs };\r\n//   } catch (error) {\r\n//     console.error('Error scraping LinkedIn:', error);\r\n//     await browser.close();\r\n//     return {\r\n//       status: 'error',\r\n//       message: error instanceof Error ? error.message : 'Unknown error'\r\n//     };\r\n//   }\r\n// };\r\n\r\nfunction convertRelativeDate(relativeDate: string): string {\r\n  const now = new Date();\r\n\r\n  const regex = /(\\d+)\\s*(day|week|month|year)s?\\s*ago/i;\r\n  const match = relativeDate.match(regex);\r\n\r\n  if (match) {\r\n    const value = parseInt(match[1], 10);\r\n    const unit = match[2];\r\n\r\n    let exactDate;\r\n    if (unit === 'day') {\r\n      exactDate = subDays(now, value);\r\n    } else if (unit === 'week') {\r\n      exactDate = subWeeks(now, value);\r\n    } else if (unit === 'month') {\r\n      exactDate = subMonths(now, value);\r\n    } else if (unit === 'year') {\r\n      exactDate = subYears(now, value);\r\n    } else {\r\n      return format(now, 'yyyy-MM-dd'); // Default to today if unknown\r\n    }\r\n\r\n    return format(exactDate, 'yyyy-MM-dd'); // Convert to \"YYYY-MM-DD\"\r\n  }\r\n\r\n  return format(now, 'yyyy-MM-dd'); // Default to today if format is unknown\r\n}\r\n\r\nexport const fetchLinkedInJobs =\r\n  async (): Promise<FetchLinkedInJobsResponse> => {\r\n    console.log('Deleting all jobs with jobTrigger: Automation');\r\n\r\n    if (!(await checkLinkedInTableExists()))\r\n      throw new Error(`Table '${TABLE_LINKEDIN_JOBS}' does not exist.`);\r\n\r\n    // Delete all jobs where jobTrigger = 'Automation'\r\n    const deleteJobBoard = await bigquery.query({\r\n      query: linkedInQueries.deleteOldAutomationJobs\r\n    });\r\n\r\n    console.log('Deleted Data', JSON.stringify(deleteJobBoard));\r\n    console.log('After 1 months old Automation jobs deleted successfully.');\r\n\r\n    const browser = await chromium.launch({ headless: false }); // Debugging\r\n    const page = await browser.newPage();\r\n    let allJobs: LinkedIn[] = [];\r\n\r\n    // ✅ Define job roles inside the function\r\n    // const jobRoles = [\r\n    //   'Data Analyst',\r\n    //   'Data Scientist',\r\n    //   'Data Engineering',\r\n    //   'Full-Stack',\r\n    //   'Software Engineering'\r\n    // ];\r\n    const jobRoles = [\r\n      'Data Scientist',\r\n      'Junior Data Scientist',\r\n      'Senior Data Scientist',\r\n      'Lead Data Scientist',\r\n      'Principal Data Scientist',\r\n      'Data Science Consultant',\r\n      'Data Science Manager',\r\n      'Applied Data Scientist',\r\n      'AI Scientist',\r\n      'Machine Learning Engineer',\r\n      'Senior Machine Learning Engineer',\r\n      'Lead Machine Learning Engineer',\r\n      'Principal Machine Learning Engineer',\r\n      'Machine Learning Researcher',\r\n      'AI Engineer',\r\n      'AI Specialist',\r\n      'AI Research Scientist',\r\n      'NLP Engineer',\r\n      'Computer Vision Engineer',\r\n      'Deep Learning Engineer',\r\n      'AI Product Manager',\r\n      'AI Solutions Architect',\r\n      'AI Consultant',\r\n      'Associate Data Scientist',\r\n      'Research Data Scientist',\r\n      'Data Science Engineer',\r\n      'Computational Data Scientist',\r\n      'Statistical Data Scientist',\r\n      'Machine Learning Developer',\r\n      'AI/ML Engineer',\r\n      'Applied Machine Learning Engineer',\r\n      'AI Algorithm Engineer',\r\n      'Data Engineer',\r\n      'Senior Data Engineer',\r\n      'Lead Data Engineer',\r\n      'Principal Data Engineer',\r\n      'Big Data Engineer',\r\n      'Cloud Data Engineer',\r\n      'ETL Developer',\r\n      'Data Architect',\r\n      'Database Engineer',\r\n      'Data Infrastructure Engineer',\r\n      'DataOps Engineer',\r\n      'Data Pipeline Engineer',\r\n      'Hadoop Engineer',\r\n      'Snowflake Engineer',\r\n      'Data Platform Engineer',\r\n      'Data Engineering Consultant',\r\n      'Data Pipeline Developer',\r\n      'ETL Engineer',\r\n      'Big Data Consultant',\r\n      'Spark Engineer',\r\n      'Cloud Data Solutions Engineer',\r\n      'Data Analyst',\r\n      'Junior Data Analyst',\r\n      'Senior Data Analyst',\r\n      'Data Science Analyst',\r\n      'Business Data Analyst',\r\n      'Quantitative Data Analyst',\r\n      'Decision Science Analyst',\r\n      'Data Insights Analyst',\r\n      'Reporting Analyst',\r\n      'BI Data Analyst',\r\n      'BI Reporting Analyst',\r\n      'Data Visualization Analyst',\r\n      'Marketing Data Analyst',\r\n      'Financial Data Analyst',\r\n      'Product Data Analyst',\r\n      'Risk Data Analyst',\r\n      'Healthcare Data Analyst',\r\n      'Customer Insights Analyst',\r\n      'Operations Data Analyst',\r\n      'HR Data Analyst',\r\n      'Workforce Analyst',\r\n      'Pricing Analyst',\r\n      'Fraud Analyst',\r\n      'Predictive Analytics Specialist',\r\n      'Operations Research Analyst',\r\n      'Data Strategy Analyst',\r\n      'Insights & Analytics Manager',\r\n      'Business Intelligence Consultant',\r\n      'ETL Analyst',\r\n      'Big Data Analyst',\r\n      'Power BI Developer',\r\n      'Tableau Developer',\r\n      'Generative AI Engineer',\r\n      'AI Prompt Engineer',\r\n      'AI Solutions Engineer',\r\n      'AI Developer',\r\n      'AI Research Engineer',\r\n      'AI Data Engineer',\r\n      'AI Product Manager',\r\n      'AI Content Creator',\r\n      'AI Chatbot Developer',\r\n      'AI Ethics Specialist',\r\n      'AI Prompt Specialist',\r\n      'AI Application Engineer',\r\n      'Conversational AI Engineer',\r\n      'AI Data Scientist',\r\n      'AI/ML Consultant',\r\n      'AI System Engineer',\r\n      'LLM Engineer',\r\n      'AI Automation Engineer',\r\n      'AI Innovation Engineer',\r\n      'ML Engineer (Generative AI)',\r\n      'Foundation Model Engineer',\r\n      'Data Labeling Specialist',\r\n      'Domo Developer',\r\n      'Domo Analyst',\r\n      'Domo Consultant',\r\n      'Domo Engineer',\r\n      'BI Developer (Domo)',\r\n      'Data Visualization Specialist (Domo)',\r\n      'Data Visualization Engineer',\r\n      'Dashboard Developer',\r\n      'BI & Reporting Specialist',\r\n      'Data Dashboard Designer'\r\n    ];\r\n\r\n    // ✅ Define locations inside the function\r\n    const locations = ['India'];\r\n\r\n    // Set to track unique entityURNs during scraping\r\n    const scrapedEntityURNs = new Set<string>();\r\n\r\n    try {\r\n      for (const role of jobRoles) {\r\n        for (const location of locations) {\r\n          let hasMoreJobs = true;\r\n          let currentPage = 0;\r\n\r\n          while (hasMoreJobs && currentPage < 5) {\r\n            // while (hasMoreJobs) {\r\n            // Prevent infinite loop\r\n            const LINKEDIN_URL = `https://www.linkedin.com/jobs/search/?keywords=${encodeURIComponent(\r\n              role\r\n            )}&location=${encodeURIComponent(location)}&start=${currentPage * 20}`;\r\n\r\n            try {\r\n              console.log(`Navigating to: ${LINKEDIN_URL}`);\r\n              await page.goto(LINKEDIN_URL, {\r\n                waitUntil: 'networkidle',\r\n                timeout: 60000\r\n              });\r\n\r\n              const jobCards = await page.$$('.job-search-card');\r\n              if (jobCards.length === 0) {\r\n                console.log(`No jobs found for ${role} in ${location}`);\r\n                hasMoreJobs = false;\r\n                break;\r\n              }\r\n\r\n              const jobs: LinkedIn[] = [];\r\n              for (const card of jobCards) {\r\n                const job = await card.evaluate((node) => ({\r\n                  title:\r\n                    node\r\n                      .querySelector('.base-search-card__title')\r\n                      ?.textContent?.trim() || 'No title',\r\n                  company:\r\n                    node\r\n                      .querySelector('.base-search-card__subtitle')\r\n                      ?.textContent?.trim() || 'No company',\r\n                  link:\r\n                    node\r\n                      .querySelector('.base-card__full-link')\r\n                      ?.getAttribute('href') || 'No link',\r\n                  location:\r\n                    node\r\n                      .querySelector('.job-search-card__location')\r\n                      ?.textContent?.trim() || 'No location',\r\n                  datePosted:\r\n                    node\r\n                      .querySelector('.job-search-card__listdate')\r\n                      ?.textContent?.trim() || 'No date',\r\n                  entityURN: node.getAttribute('data-entity-urn')?.trim() || '', // Ensure no empty URNs\r\n                  imgSrc:\r\n                    node\r\n                      .querySelector('.artdeco-entity-image')\r\n                      ?.getAttribute('src') || 'No image',\r\n                  jobDescription:\r\n                    node\r\n                      .querySelector('.job-search-card__desc')\r\n                      ?.textContent?.trim() || 'No description'\r\n                }));\r\n\r\n                // Ensure entityURN is valid and not already scraped\r\n                if (job.entityURN && !scrapedEntityURNs.has(job.entityURN)) {\r\n                  scrapedEntityURNs.add(job.entityURN); // Add to Set to avoid duplicates\r\n\r\n                  jobs.push({\r\n                    id: uuidv4(),\r\n                    ...job,\r\n                    createdAt: new Date().toISOString(),\r\n                    jobTrigger: 'Automation',\r\n                    carrierPathLink: ''\r\n                  });\r\n                }\r\n              }\r\n\r\n              if (jobs.length === 0) {\r\n                hasMoreJobs = false;\r\n              } else {\r\n                allJobs = allJobs.concat(jobs);\r\n                currentPage++;\r\n              }\r\n            } catch (error) {\r\n              console.error(\r\n                `Error loading page for \"${role}\" in \"${location}\":`,\r\n                error\r\n              );\r\n              hasMoreJobs = false;\r\n            }\r\n            await page.waitForTimeout(5000); // Avoid detection\r\n          }\r\n        }\r\n      }\r\n\r\n      await browser.close();\r\n\r\n      if (allJobs.length > 0) {\r\n        await storeJobsInBigQuery(allJobs);\r\n        console.log(`Fetched and stored ${allJobs.length} unique jobs.`);\r\n      } else {\r\n        console.log('No jobs found.');\r\n      }\r\n\r\n      return { status: 'success', jobs: allJobs };\r\n    } catch (error) {\r\n      console.error('Error scraping LinkedIn:', error);\r\n      await browser.close();\r\n      return {\r\n        status: 'error',\r\n        message: error instanceof Error ? error.message : 'Unknown error'\r\n      };\r\n    }\r\n  };\r\n\r\n// Used to store the LinkedIn data in bigquery\r\nconst storeJobsInBigQuery = async (jobs: any[]) => {\r\n  await createLinkedInTableIfNotExists();\r\n\r\n  try {\r\n    const existingEntityURNs = await getExistingEntityURNs();\r\n    console.log('Existing entityURNs:', existingEntityURNs);\r\n\r\n    // Ensure unique jobs filtering works correctly\r\n    const uniqueJobs = jobs.filter((job) => {\r\n      const isDuplicate = existingEntityURNs.has(job.entityURN);\r\n      if (isDuplicate) {\r\n        console.log(`Duplicate job skipped: ${job.entityURN}`);\r\n      }\r\n      return !isDuplicate;\r\n    });\r\n\r\n    console.log('Final unique jobs to store:', uniqueJobs);\r\n\r\n    if (uniqueJobs.length === 0) {\r\n      console.log('No new unique jobs to store.');\r\n      return;\r\n    }\r\n\r\n    const createdAt = new Date().toISOString();\r\n\r\n    for (const job of uniqueJobs) {\r\n      await bigquery.query({\r\n        query: linkedInQueries.insertLinkedInJob,\r\n        params: {\r\n          id: uuidv4(),\r\n          title: job.title,\r\n          company: job.company,\r\n          link: job.link,\r\n          carrierPathLink: job.carrierPathLink || '',\r\n          location: job.location,\r\n          datePosted: convertRelativeDate(job.datePosted),\r\n          entityURN: job.entityURN,\r\n          imgSrc: job.imgSrc,\r\n          jobDescription: job.jobDescription,\r\n          jobTrigger: job.jobTrigger || 'Automation',\r\n          createdAt: job.createdAt || createdAt\r\n        }\r\n      });\r\n    }\r\n\r\n    console.log(`Stored ${uniqueJobs.length} unique jobs in BigQuery.`);\r\n  } catch (error) {\r\n    console.error('Error inserting jobs into BigQuery:', error);\r\n  }\r\n};\r\n\r\n// **Get All Linkedin Datas **\r\nexport const getAllLinkedInHandler = async () => {\r\n  await checkLinkedInTableExists();\r\n  try {\r\n    console.log('Fetching all LinkedIn Datas...');\r\n    const [rows] = await bigquery.query({\r\n      query: linkedInQueries.getAllLinkedInJobs\r\n    });\r\n    console.log(`Total LinkedIn found: ${rows.length}`);\r\n    return rows;\r\n  } catch (error) {\r\n    console.error('Error fetching all LinkedIn Datas:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Get all Jobs for admin and trainee - not trigger\r\n// export const getAllJobsHandler = async () => {\r\n//   try {\r\n//     const [rows] = await bigquery.query({\r\n//       query: linkedInQueries.getAllLinkedInJobs\r\n//     });\r\n\r\n//     return { jobs: rows };\r\n//   } catch (error: any) {\r\n//     console.error('Error fetching job roles:', error.message, error);\r\n//     throw new Error(`Fetching job roles failed: ${error.message}`);\r\n//   }\r\n// };\r\n\r\n//Update LinkedIn imgsrc\r\nexport const updateLinkedInJobHandler = async (\r\n  company: string,\r\n  file?: Express.Multer.File\r\n) => {\r\n  try {\r\n    console.log(`Updating imgSrc for Company: ${company}`);\r\n\r\n    // Check if the table exists\r\n    if (!(await checkLinkedInTableExists())) {\r\n      return {\r\n        success: false,\r\n        message: `Table ${TABLE_LINKEDIN_JOBS} does not exist.`\r\n      };\r\n    }\r\n\r\n    // Fetch existing job data for the company\r\n    const [linkedInResults] = await bigquery.query({\r\n      query: `SELECT * FROM \\`teqcertify.lms.${TABLE_LINKEDIN_JOBS}\\` WHERE company = @company`,\r\n      params: { company }\r\n    });\r\n\r\n    if (!Array.isArray(linkedInResults) || linkedInResults.length === 0) {\r\n      console.error(`No jobs found for company ${company}.`);\r\n      return {\r\n        success: false,\r\n        message: `No jobs found for company ${company}.`\r\n      };\r\n    }\r\n\r\n    let uploadedImgUrl = linkedInResults[0].imgSrc;\r\n\r\n    // Upload new image to GCS if provided\r\n    if (file) {\r\n      const fileName = `${company.replace(/\\s+/g, '_')}.${file.mimetype.split('/')[1]}`;\r\n      console.log('Uploading new job image to GCS...');\r\n      uploadedImgUrl = await uploadLinkedInImageToGCS(\r\n        file.buffer,\r\n        fileName,\r\n        file.mimetype\r\n      );\r\n    } else {\r\n      return { success: false, message: 'No image file provided.' };\r\n    }\r\n\r\n    // Update the imgSrc field for all jobs under the company\r\n    await bigquery.query({\r\n      query: `UPDATE \\`teqcertify.lms.${TABLE_LINKEDIN_JOBS}\\` SET imgSrc = @imgSrc WHERE company = @company`,\r\n      params: { imgSrc: uploadedImgUrl, company }\r\n    });\r\n\r\n    console.log(`Updated imgSrc for all jobs at company ${company}.`);\r\n\r\n    return {\r\n      success: true,\r\n      message: `Updated imgSrc for all jobs at company ${company}.`,\r\n      imgSrc: uploadedImgUrl\r\n    };\r\n  } catch (error) {\r\n    console.error(`Error updating imgSrc for company ${company}:`, error);\r\n    return {\r\n      success: false,\r\n      message: 'Internal server error occurred.',\r\n      error\r\n    };\r\n  }\r\n};\r\n\r\n//Update CarrierPath Link\r\nexport const updateCarrierPathLinkJobHandler = async (\r\n  id: string,\r\n  updatedData: Partial<LinkedIn>\r\n) => {\r\n  try {\r\n    console.log(`Updating carrierPathLink for Job ID: ${id}`);\r\n\r\n    // Check if the table exists\r\n    if (!(await checkLinkedInTableExists())) {\r\n      return {\r\n        success: false,\r\n        message: `Table ${TABLE_LINKEDIN_JOBS} does not exist.`\r\n      };\r\n    }\r\n\r\n    // Fetch existing job data by ID\r\n    const [linkedInResults] = await bigquery.query({\r\n      query: `SELECT * FROM \\`teqcertify.lms.${TABLE_LINKEDIN_JOBS}\\` WHERE id = @id`,\r\n      params: { id }\r\n    });\r\n\r\n    if (!Array.isArray(linkedInResults) || linkedInResults.length === 0) {\r\n      console.error(`No job found for ID ${id}.`);\r\n      return { success: false, message: `No job found for ID ${id}.` };\r\n    }\r\n\r\n    // Validate if `carrierPathLink` exists in the updated data\r\n    if (!updatedData.carrierPathLink) {\r\n      return {\r\n        success: false,\r\n        message: 'carrierPathLink is required for update.'\r\n      };\r\n    }\r\n\r\n    // Update only carrierPathLink\r\n    await bigquery.query({\r\n      query: `UPDATE \\`teqcertify.lms.${TABLE_LINKEDIN_JOBS}\\` SET carrierPathLink = @carrierPathLink WHERE id = @id`,\r\n      params: { id, carrierPathLink: updatedData.carrierPathLink }\r\n    });\r\n\r\n    console.log(`Updated carrierPathLink for Job ID ${id}.`);\r\n\r\n    return {\r\n      success: true,\r\n      message: `Updated carrierPathLink for Job ID ${id}.`,\r\n      carrierPathLink: updatedData.carrierPathLink\r\n    };\r\n  } catch (error) {\r\n    console.error(`Error updating carrierPathLink for Job ID ${id}:`, error);\r\n    return {\r\n      success: false,\r\n      message: 'Internal server error occurred.',\r\n      error\r\n    };\r\n  }\r\n};\r\n\r\n// **Delete JobBoard Handler**\r\nexport const deleteLinkedInJobHandler = async (id: string, req: any) => {\r\n  const { user } = req;\r\n  try {\r\n    console.log(`Deleting JobBoard with ID: ${id}`);\r\n\r\n    if (!(await checkLinkedInTableExists()))\r\n      throw new Error(`Table '${TABLE_LINKEDIN_JOBS}' does not exist.`);\r\n\r\n    const [rows] = await bigquery.query({\r\n      query: linkedInQueries.getAllLinkedInJobs,\r\n      params: { id }\r\n    });\r\n\r\n    if (!rows.length) {\r\n      console.log('JobBoard not found.');\r\n      return { success: false, message: 'JobBoard not found.' };\r\n    }\r\n\r\n    const deleteJobBoard = await bigquery.query({\r\n      query: linkedInQueries.deleteJobBoard,\r\n      params: { jobId: id } // ✅ Fix: Match the parameter name\r\n    });\r\n\r\n    // Insert Audit Log\r\n    const auditLogParams = {\r\n      entityType: 'LinkedInJob',\r\n      entityId: id,\r\n      action: 'DELETE',\r\n      previousData: JSON.stringify(deleteJobBoard),\r\n      performedBy: user?.id\r\n    };\r\n\r\n    await bigquery.query({\r\n      query: auditQueries.insertAuditLog,\r\n      params: auditLogParams\r\n    });\r\n\r\n    console.log(`JobBoard with ID ${id} deleted successfully.`);\r\n\r\n    return {\r\n      success: true,\r\n      message: `JobBoard with ID ${id} deleted successfully.`\r\n    };\r\n  } catch (error) {\r\n    console.error(`Error deleting jobBoard with ID ${id}:`, error);\r\n    return { success: false, errors: ['Internal server error occurred.'] };\r\n  }\r\n};\r\n\r\nexport const deleteLinkedInAutomationJobHandler = async (req: any) => {\r\n  const { user } = req;\r\n  try {\r\n    console.log('Deleting all jobs with jobTrigger: Automation');\r\n\r\n    if (!(await checkLinkedInTableExists()))\r\n      throw new Error(`Table '${TABLE_LINKEDIN_JOBS}' does not exist.`);\r\n\r\n    // Delete all jobs where jobTrigger = 'Automation'\r\n    const deleteJobBoard = await bigquery.query({\r\n      query: linkedInQueries.deleteAllAutomationJobs\r\n    });\r\n\r\n    // Insert Audit Log for this bulk deletion\r\n    await bigquery.query({\r\n      query: auditQueries.insertAuditLog,\r\n      params: {\r\n        entityType: 'LinkedInJob',\r\n        entityId: 'ALL_AUTOMATION',\r\n        action: 'DELETE',\r\n        previousData: JSON.stringify(deleteJobBoard),\r\n        performedBy: user?.id\r\n      }\r\n    });\r\n\r\n    console.log('All Automation jobs deleted successfully.');\r\n\r\n    return {\r\n      success: true,\r\n      message: 'All Automation jobs deleted successfully.'\r\n    };\r\n  } catch (error) {\r\n    console.error('Error deleting Automation jobs:', error);\r\n    return { success: false, errors: ['Internal server error occurred.'] };\r\n  }\r\n};\r\n"],"mappings":"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B,OAAO,GAAG;IAC7C,CAAC;EACH;AACF,CAAC;;AAED;AAAAsB,OAAA,CAAArC,wBAAA,GAAAA,wBAAA;AACA,MAAMsC,qBAAqB,GAAG,MAAAA,CAAA,KAAkC;EAC9D,IAAI;IACF,MAAM7C,KAAK,GAAG;AAClB;AACA,eAAeL,OAAO,CAACC,GAAG,CAAC4B,UAAU,IAAI7B,OAAO,CAACC,GAAG,CAAC6B,UAAU,IAAI9B,OAAO,CAACC,GAAG,CAACF,mBAAmB;AAClG,KAAK;IAED,MAAM,CAACI,IAAI,CAAC,GAAG,MAAMC,kBAAQ,CAACC,KAAK,CAAC;MAAEA;IAAM,CAAC,CAAC;IAC9C,OAAO,IAAI8C,GAAG,CAAChD,IAAI,CAACiD,GAAG,CAAEC,GAAQ,IAAKA,GAAG,CAAChC,SAAS,CAAC,CAAC;EACvD,CAAC,CAAC,OAAOZ,KAAK,EAAE;IACdH,OAAO,CAACG,KAAK,CAAC,qCAAqC,EAAEA,KAAK,CAAC;IAC3D,OAAO,IAAI0C,GAAG,CAAC,CAAC;EAClB;AACF,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AA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","ignoreList":[]}
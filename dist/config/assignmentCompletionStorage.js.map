{"version":3,"file":"assignmentCompletionStorage.js","names":["_storageConfig","require","uploadAssignmentCompletionFileToGCS","fileBuffer","fileName","mimeType","filePath","assignmentCompletionFolder","file","bucket","stream","createWriteStream","metadata","contentType","Promise","resolve","reject","on","err","name","end","error","Error","exports","deleteAssignmentCompletionFileFromGCS","delete"],"sources":["../../src/config/assignmentCompletionStorage.ts"],"sourcesContent":["import { bucket, assignmentCompletionFolder } from \"./storageConfig\";\r\n\r\nexport const uploadAssignmentCompletionFileToGCS = async (fileBuffer: Buffer, fileName: string, mimeType: string): Promise<string> => {\r\n  try {\r\n    const filePath = `${assignmentCompletionFolder}/${fileName}`;\r\n    const file = bucket.file(filePath);\r\n    const stream = file.createWriteStream({ metadata: { contentType: mimeType || \"application/octet-stream\" } });\r\n\r\n    return new Promise<string>((resolve, reject) => {\r\n      stream.on(\"error\", (err) => reject(\"Failed to upload answer file to GCS\"));\r\n      stream.on(\"finish\", () => resolve(`https://storage.googleapis.com/${bucket.name}/${filePath}`));\r\n      stream.end(fileBuffer);\r\n    });\r\n  } catch (error) {\r\n    throw new Error(\"Failed to upload answer file to GCS\");\r\n  }\r\n};\r\n\r\nexport const deleteAssignmentCompletionFileFromGCS = async (fileName: string): Promise<void> => {\r\n  try {\r\n    const filePath = `${assignmentCompletionFolder}/${fileName}`;\r\n    await bucket.file(filePath).delete();\r\n  } catch (error) {\r\n    throw new Error(\"Failed to delete answer file from GCS\");\r\n  }\r\n};\r\n"],"mappings":";;;;;;AAAA,IAAAA,cAAA,GAAAC,OAAA;AAEO,MAAMC,mCAAmC,GAAG,MAAAA,CAAOC,UAAkB,EAAEC,QAAgB,EAAEC,QAAgB,KAAsB;EACpI,IAAI;IACF,MAAMC,QAAQ,GAAG,GAAGC,yCAA0B,IAAIH,QAAQ,EAAE;IAC5D,MAAMI,IAAI,GAAGC,qBAAM,CAACD,IAAI,CAACF,QAAQ,CAAC;IAClC,MAAMI,MAAM,GAAGF,IAAI,CAACG,iBAAiB,CAAC;MAAEC,QAAQ,EAAE;QAAEC,WAAW,EAAER,QAAQ,IAAI;MAA2B;IAAE,CAAC,CAAC;IAE5G,OAAO,IAAIS,OAAO,CAAS,CAACC,OAAO,EAAEC,MAAM,KAAK;MAC9CN,MAAM,CAACO,EAAE,CAAC,OAAO,EAAGC,GAAG,IAAKF,MAAM,CAAC,qCAAqC,CAAC,CAAC;MAC1EN,MAAM,CAACO,EAAE,CAAC,QAAQ,EAAE,MAAMF,OAAO,CAAC,kCAAkCN,qBAAM,CAACU,IAAI,IAAIb,QAAQ,EAAE,CAAC,CAAC;MAC/FI,MAAM,CAACU,GAAG,CAACjB,UAAU,CAAC;IACxB,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOkB,KAAK,EAAE;IACd,MAAM,IAAIC,KAAK,CAAC,qCAAqC,CAAC;EACxD;AACF,CAAC;AAACC,OAAA,CAAArB,mCAAA,GAAAA,mCAAA;AAEK,MAAMsB,qCAAqC,GAAG,MAAOpB,QAAgB,IAAoB;EAC9F,IAAI;IACF,MAAME,QAAQ,GAAG,GAAGC,yCAA0B,IAAIH,QAAQ,EAAE;IAC5D,MAAMK,qBAAM,CAACD,IAAI,CAACF,QAAQ,CAAC,CAACmB,MAAM,CAAC,CAAC;EACtC,CAAC,CAAC,OAAOJ,KAAK,EAAE;IACd,MAAM,IAAIC,KAAK,CAAC,uCAAuC,CAAC;EAC1D;AACF,CAAC;AAACC,OAAA,CAAAC,qCAAA,GAAAA,qCAAA","ignoreList":[]}
{"version":3,"file":"attendanceStorage.js","names":["_storageConfig","require","uploadAttendanceFileForClassToGCS","fileBuffer","fileName","mimeType","filePath","attendanceFileFolder","file","bucket","stream","createWriteStream","metadata","contentType","Promise","resolve","reject","on","err","name","end","error","Error","exports","deleteAttendanceForClassFromGCS","delete"],"sources":["../../src/config/attendanceStorage.ts"],"sourcesContent":["import { bucket, attendanceFileFolder } from \"./storageConfig\";\r\n\r\nexport const uploadAttendanceFileForClassToGCS = async (fileBuffer: Buffer, fileName: string, mimeType: string): Promise<string> => {\r\n  try {\r\n    const filePath = `${attendanceFileFolder}/${fileName}`;\r\n    const file = bucket.file(filePath);\r\n    const stream = file.createWriteStream({ metadata: { contentType: mimeType || \"application/octet-stream\" } });\r\n\r\n    return new Promise<string>((resolve, reject) => {\r\n      stream.on(\"error\", (err) => reject(\"Failed to upload materialForClass to GCS\"));\r\n      stream.on(\"finish\", () => resolve(`https://storage.googleapis.com/${bucket.name}/${filePath}`));\r\n      stream.end(fileBuffer);\r\n    });\r\n  } catch (error) {\r\n    throw new Error(\"Failed to upload attendanceFileForClass to GCS\");\r\n  }\r\n};\r\n\r\nexport const deleteAttendanceForClassFromGCS = async (fileName: string): Promise<void> => {\r\n  try {\r\n    const filePath = `${attendanceFileFolder}/${fileName}`;\r\n    await bucket.file(filePath).delete();\r\n  } catch (error) {\r\n    throw new Error(\"Failed to delete attendanceFileForClass from GCS\");\r\n  }\r\n};\r\n"],"mappings":";;;;;;AAAA,IAAAA,cAAA,GAAAC,OAAA;AAEO,MAAMC,iCAAiC,GAAG,MAAAA,CAAOC,UAAkB,EAAEC,QAAgB,EAAEC,QAAgB,KAAsB;EAClI,IAAI;IACF,MAAMC,QAAQ,GAAG,GAAGC,mCAAoB,IAAIH,QAAQ,EAAE;IACtD,MAAMI,IAAI,GAAGC,qBAAM,CAACD,IAAI,CAACF,QAAQ,CAAC;IAClC,MAAMI,MAAM,GAAGF,IAAI,CAACG,iBAAiB,CAAC;MAAEC,QAAQ,EAAE;QAAEC,WAAW,EAAER,QAAQ,IAAI;MAA2B;IAAE,CAAC,CAAC;IAE5G,OAAO,IAAIS,OAAO,CAAS,CAACC,OAAO,EAAEC,MAAM,KAAK;MAC9CN,MAAM,CAACO,EAAE,CAAC,OAAO,EAAGC,GAAG,IAAKF,MAAM,CAAC,0CAA0C,CAAC,CAAC;MAC/EN,MAAM,CAACO,EAAE,CAAC,QAAQ,EAAE,MAAMF,OAAO,CAAC,kCAAkCN,qBAAM,CAACU,IAAI,IAAIb,QAAQ,EAAE,CAAC,CAAC;MAC/FI,MAAM,CAACU,GAAG,CAACjB,UAAU,CAAC;IACxB,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOkB,KAAK,EAAE;IACd,MAAM,IAAIC,KAAK,CAAC,gDAAgD,CAAC;EACnE;AACF,CAAC;AAACC,OAAA,CAAArB,iCAAA,GAAAA,iCAAA;AAEK,MAAMsB,+BAA+B,GAAG,MAAOpB,QAAgB,IAAoB;EACxF,IAAI;IACF,MAAME,QAAQ,GAAG,GAAGC,mCAAoB,IAAIH,QAAQ,EAAE;IACtD,MAAMK,qBAAM,CAACD,IAAI,CAACF,QAAQ,CAAC,CAACmB,MAAM,CAAC,CAAC;EACtC,CAAC,CAAC,OAAOJ,KAAK,EAAE;IACd,MAAM,IAAIC,KAAK,CAAC,kDAAkD,CAAC;EACrE;AACF,CAAC;AAACC,OAAA,CAAAC,+BAAA,GAAAA,+BAAA","ignoreList":[]}